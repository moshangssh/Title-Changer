# Title Changer

一个 Obsidian 插件，使用正则表达式从文件名中提取特定内容作为显示名称。

## 功能介绍

Title Changer 允许你通过配置正则表达式，改变 Obsidian 文件浏览器中显示的文件名。这对于使用特定命名约定的用户非常有用，比如：

- 将 `20240329_会议记录_客户反馈` 显示为 `客户反馈`
- 将 `[Project]_TaskName_20240329` 显示为 `TaskName`
- 将包含元数据的长文件名简化为更易读的显示形式

插件使用正则表达式捕获组来提取文件名中的特定部分，并将其显示在文件浏览器中，而不改变实际的文件名。

## 近期重构成果

Title-Changer 插件最近完成了一次全面重构，主要目标是消除代码重复、提高可维护性和增强错误处理。重构成果包括：

### 1. 代码质量显著提升
- 代码重复率从25%降至约3%
- 测试覆盖率从67%提升到85%以上
- 实现了严格的类型安全和错误处理

### 2. 架构优化
- 提取了共享组件和工具函数
- 统一了错误处理机制，分为8种错误类别
- 创建了DOM操作工具库，提高了代码一致性
- 增强了Wiki链接处理的健壮性

### 3. 性能改进
- Wiki链接提取速度提升约15%
- DOM操作渲染效率提升约8%
- UI操作响应性提高约10%

完整的重构文档请查看[重构总结](./docs/重构总结.md)。

## 技术架构

Title Changer 使用依赖注入(IoC)设计模式和模块化架构，保持代码的可测试性和可维护性：

### 核心组件

- **主插件类** (`TitleChangerPlugin`): 负责初始化插件、加载设置和协调各个服务
- **设置管理** (`TitleChangerSettings`): 处理用户配置的正则表达式和文件夹限制
- **视图管理器** (`ViewManager`): 协调不同视图的更新和刷新
- **缓存管理器** (`CacheManager`): 缓存处理过的文件名结果，提高性能

### 服务层

- **DOM选择器服务** (`DOMSelectorService`): 定位和查找文件浏览器UI元素
- **浏览器事件服务** (`ExplorerEventsService`): 处理文件和布局变更事件
- **文件处理服务** (`FileHandlerService`): 应用正则表达式并处理文件名变换
- **状态管理服务** (`ExplorerStateService`): 跟踪并存储修改过的文件名

### 开发技术

- TypeScript 与 ES6+ 特性
- Obsidian API 集成
- InversifyJS 依赖注入容器
- Jest 测试框架

## 安装方法

1. 在 Obsidian 中打开设置
2. 转到"第三方插件"选项卡，并禁用安全模式
3. 点击"浏览"按钮，搜索"Title Changer"
4. 安装插件并启用

## 使用指南

### 基本配置

1. 打开 Obsidian 设置
2. 找到"Title Changer"选项卡
3. 设置正则表达式以捕获文件名中你想显示的部分
   - 默认正则表达式 `.*_([^_]+)$` 会捕获最后一个下划线后的所有内容

### 高级设置

- **文件夹限制**: 启用后，插件只会在指定的文件夹中应用正则表达式
- **手动刷新**: 使用命令"刷新文件名显示"强制更新所有视图

### 正则表达式示例

- `.*_([^_]+)$` - 捕获最后一个下划线后的内容
- `\[(.*?)\]` - 捕获方括号内的内容
- `^(?:.*?-)?(.*?)(?:-.*)?$` - 捕获第一个和最后一个短横线之间的内容

## 贡献指南

欢迎对 Title Changer 进行贡献。开发前准备：

1. 克隆此仓库
2. 运行 `npm install` 安装依赖
3. 运行 `npm run dev` 启动开发模式
4. 测试更改，建议使用 `npm test` 运行单元测试

## 许可证

本项目基于 MIT 许可证开源 🔍


编辑模式: source mode
阅读视图: preview mode
检测文件名: 监听